# BC-macro
경제성 분석을 위한 EMME 매크로 패키지

## 개요
이 패키지는 교통 프로젝트의 경제적 편익-비용 분석(Benefit-Cost Analysis)을 수행하기 위한 EMME 매크로들을 포함합니다. 주로 한국의 교통 정책 및 도로 프로젝트 평가에 사용되는 경제적 지표들을 계산합니다.

## 주요 기능
1. **차량운행비용(VOCS) 계산** - 연료비, 유지비 등 차량 운행과 관련된 비용
2. **시간가치(VOTS) 계산** - 통행시간 절약에 따른 경제적 가치
3. **교통사고비용(VICS) 계산** - 교통사고 감소에 따른 편익
4. **대기오염비용(VOPCS) 계산** - 배기가스 감소에 따른 환경 편익
5. **소음비용(VONCS) 계산** - 교통소음 감소에 따른 편익

## 매크로 파일 설명

### 핵심 분석 매크로
- **`Benefit.mac`** - 전체 편익 계산의 메인 매크로
- **`+bc-1.mac`** - 단일 시나리오 편익-비용 분석 실행
- **`+bc-st.mac`** - 다중 시나리오 편익-비용 분석 실행

### 교통량 및 속도 계산 매크로
- **`volatt-bc.mac`** - 교통량과 속도 속성 생성 및 계산
- **`ResultBC.mac`** - 분석 결과 추출 및 정리
- **`+loopassignment.mac`** - 반복 교통배정 수행

### 보조 매크로
- **`242c.mac`** - 특정 링크 선택 및 표시
- **`+reflect-all.mac`** - 전체 네트워크 반영
- **`(peak)loopassignment.mac`** - 첨두시간 반복 배정
- **`(npeak)loopassignment.mac`** - 비첨두시간 반복 배정
- **`ddd.mac`** - 디버깅 및 테스트용

## 사용 방법

### 1. 기본 설정
매크로 실행 전 다음 조건들이 준비되어야 합니다:
- EMME 프로젝트가 설정되어 있어야 함
- 네트워크 데이터 (노드, 링크, VDF 함수)
- 통행수요 매트릭스 (시간대별)
- 차종별 구성비 설정

### 2. 주요 매개변수
```
차종별 구성비:
- r1=0.786701 (승용차)
- r2=0.003427 (버스)  
- r3=0.154045 (소형화물차)
- r4=0.029522 (중형화물차)
- r5=0.026303 (대형화물차)

시간대별 지속시간:
- 첨두시간: 5시간
- 비첨두시간: 14시간
- 보정계수: 0.9856
```

### 3. 실행 순서
1. **교통배정 실행**: `ResultBC.mac` 호출
2. **편익 계산**: `Benefit.mac` 호출  
3. **결과 검토**: 생성된 리포트 파일 확인

## 경제성 분석 구성요소

### 1. 차량운행비용 (VOCS)
- **공식**: 속도-운행비용 함수 기반 4차 다항식
- **적용**: 2024년 한국개발연구원 표준값 적용
- **차종별**: 승용차, 버스, 소형/중형/대형 화물차

### 2. 시간가치 (VOTS)  
- **승용차**: 23,319원/시간
- **버스**: 191,626원/시간
- **화물차**: 27,809원/시간

### 3. 교통사고비용 (VICS)
- **고속도로**: 19.78원/(대·km)
- **국도**: 58.96원/(대·km)  
- **지방도**: 153.73원/(대·km)

### 4. 대기오염비용 (VOPCS)
- 속도별 배출계수와 오염물질 비용 적용
- NOx, PM, SO2 등 대기오염물질 고려

### 5. 소음비용 (VONCS)
- 등가소음도(Leq) 계산
- 평균 소음비용: 2,859원 적용

## 출력 결과

각 매크로 실행 후 다음과 같은 링크 속성들이 생성됩니다:

| 속성명 | 설명 | 단위 |
|--------|------|------|
| @vots | 시간가치 편익 | 억원/년 |
| @vocs | 차량운행비용 편익 | 억원/년 |
| @vics | 교통사고비용 편익 | 억원/년 |
| @vopcs | 대기오염비용 편익 | 억원/년 |
| @voncs | 소음비용 편익 | 억원/년 |
| @rcl | 도로등급 (1:고속도로, 2:국도, 3:지방도) | - |

## 활용 분야

1. **도로 프로젝트 타당성 조사**
   - 고속도로, 국도, 지방도 신설/확장
   - 교통량 증가에 따른 편익 산정

2. **교통정책 효과 분석**
   - 대중교통 시설 투자
   - 교통수요관리 정책

3. **도시계획 및 개발사업**
   - 신도시 개발
   - 산업단지 조성

## 주의사항

1. **데이터 정확성**: 입력 데이터의 정확성이 결과에 큰 영향을 미칩니다
2. **시나리오 설정**: Before/After 시나리오가 명확히 구분되어야 합니다  
3. **매개변수 업데이트**: 경제적 단가는 정기적으로 업데이트가 필요합니다
4. **네트워크 코딩**: VDF 함수와 도로등급이 올바르게 설정되어야 합니다

## 참고문헌
- 한국개발연구원(2024), 교통시설 투자평가지침
- 국토교통부(2024), 교통사업 예비타당성조사 표준지침
